<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="web前端开发"><title>webpack-cms | 小方块的世界</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">webpack-cms</h1><a id="logo" href="/.">小方块的世界</a><p class="description">Stay Hungry Stay Foolish</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/favorite/"><i class="fa fa-star"> 收藏夹</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">webpack-cms</h1><div class="post-meta">Jan 27, 2019</div><div class="post-content"><p>这篇文章主要介绍了基于vue使用webpack构建的一个简单的CMS（内容管理系统），记录各个步骤的实施以及问题的解决过程。<br><a id="more"></a></p>
<h2 id="1-webpack-cms"><a href="#1-webpack-cms" class="headerlink" title="1. webpack-cms"></a>1. webpack-cms</h2><h2 id="全局设置时间过滤器"><a href="#全局设置时间过滤器" class="headerlink" title="全局设置时间过滤器"></a>全局设置时间过滤器</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装时间格式插件</span></span><br><span class="line">npm i moment -S</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在main.js中先导入moment时间格式插件再设置过滤器</span></span><br><span class="line"><span class="keyword">import</span> moment <span class="keyword">from</span> <span class="string">'moment'</span></span><br><span class="line">Vue.filter(<span class="string">'dataFormat'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">timeStr, patten=<span class="string">'YYYY-MM-DD HH:mm:ss'</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> moment(timeStr).format(patten)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>使用方法：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>时间：&#123;&#123; item.time | dataFormat &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--或者传递事件格式参数自己定义显示的时间格式--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>时间：&#123;&#123; item.time | dataFormat('YYYY-MM-DD') &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="新闻详情页制作"><a href="#新闻详情页制作" class="headerlink" title="新闻详情页制作"></a>新闻详情页制作</h2><ul>
<li><p>将新闻列表改造成router-link的形式</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注意：to前面的冒号代表v-bind:to 后面是url后面拼接id，to前面的冒号说明后面是一个表达式，表达式里面是字符串的拼接，所以要用单引号--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">"'/home/newsList/' + item.id"</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建newsInfo.vue页面</p>
</li>
<li><p>在router.js中配置新闻详情的路由</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入刚创建的页面组件</span></span><br><span class="line"><span class="keyword">import</span> newsInfo <span class="keyword">from</span> <span class="string">'./coms/news/newsInfo.vue'</span></span><br><span class="line"><span class="comment">// 注意id前面的冒号一定不能少，表示id是一个参数</span></span><br><span class="line">&#123; <span class="attr">path</span>: <span class="string">'/home/newsList/:id'</span>, <span class="attr">component</span>: newsInfo &#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p>在newsInfo.vue页面获取id</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 通过:id传递的参数用params获取，这与?传参不同</span><br><span class="line">$route.params.id</span><br></pre></td></tr></table></figure>
</li>
<li><p>info的内容使用v-html绑定</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"j-info-con"</span> <span class="attr">v-html</span>=<span class="string">"newsInfo.content"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="封装一个comment子组件"><a href="#封装一个comment子组件" class="headerlink" title="封装一个comment子组件"></a>封装一个comment子组件</h2><ul>
<li><p>在subcom文件夹中创建一个comment.vue子组件</p>
</li>
<li><p>在需要comment的页面导入comment组件</p>
<ul>
<li>import comment from ‘./comment.vue’</li>
</ul>
</li>
<li><p>在父组件中使用components将comment组件注册为自己的子组件</p>
</li>
<li><p>注册子组件时，将标签名在页面中引用即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// newsInfo.vue--从父组件把id传递给子组件 父组件中：</span><br><span class="line">&lt;comment-box :id=&quot;this.id&quot;&gt;&lt;/comment-box&gt;</span><br><span class="line">// comments.vue--子组件中添加一个props属性接受id（这个props属性与data，methods是平级的）：</span><br><span class="line">props: [&apos;id&apos;]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="点击获取更多评论数据"><a href="#点击获取更多评论数据" class="headerlink" title="点击获取更多评论数据"></a>点击获取更多评论数据</h2><ul>
<li><p>为按钮添加点击事件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;mt-button type=&quot;danger&quot; size=&quot;large&quot; plain @click=&quot;getMore&quot;&gt;加载更多&lt;/mt-button&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>点击加载更多按钮，让pageNum++，然后调用getCommentList()重新渲染数据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">getMore()&#123;</span><br><span class="line">    <span class="keyword">this</span>.pageNum++;</span><br><span class="line">    <span class="keyword">this</span>.getCommentList()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>因为每次取10条数据，为防止新数据覆盖旧数据，使用contact将数据连起来</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">getCommentList()&#123;</span><br><span class="line">    <span class="keyword">this</span>.$http.get(<span class="string">"api/getcomments/"</span>+ <span class="keyword">this</span>.id +<span class="string">"?pageindex="</span> + <span class="keyword">this</span>.pageNum).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(res.body.status === <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">// this.cmtList = res.body.message;</span></span><br><span class="line">            <span class="comment">// 为防止后面请求的数据覆盖前面的，每次加载更多都把数组数据拼接起来</span></span><br><span class="line">            <span class="keyword">this</span>.cmtList = <span class="keyword">this</span>.cmtList.concat(res.body.message)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            Toast(<span class="string">'请求数据失败'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="图片分享"><a href="#图片分享" class="headerlink" title="图片分享"></a>图片分享</h2><ul>
<li><p>制作顶部分类</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1. 使用mui中的tab-top-webview-main.html中的顶部选项卡-可左右拖动(webview)</span><br><span class="line"></span><br><span class="line">问题 1？？？</span><br><span class="line">2. 将代码copy到发现picList中发现顶到最顶端，去掉最外层的class类 mui-fullscreen，此时显示正常了，但是不能滑动，通过检查官方文档发现这是一个js组件，引入mui.js并执行初始化：</span><br><span class="line">import mui from &apos;../../lib/mui/js/mui.js&apos;</span><br><span class="line">mui(&apos;.mui-scroll-wrapper&apos;).scroll(&#123;</span><br><span class="line">deceleration: 0.0005 //flick 减速系数，系数越大，滚动速度越慢，滚动距离越小，默认值0.0006</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">问题 2？？？</span><br><span class="line">// 此时报错了！ </span><br><span class="line">Uncaught TypeError: &apos;caller&apos;, &apos;callee&apos;, and &apos;arguments&apos; properties may not be accessed on strict mode functions or the arguments objects for calls to them</span><br><span class="line"></span><br><span class="line">// 报错显示：mui.js中使用的&apos;caller&apos;, &apos;callee&apos;, and &apos;arguments&apos; 等这些属性在严格模式下不能使用，而webpack打包bundle.js默认启用的时严格模式，这用就有了冲突？？</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 3. 解决冲突：移除webpack的严格模式,使用一下插件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> https://github.com/genify/babel-plugin-transform-remove-strict-mode</span></span><br><span class="line">npm install babel-plugin-transform-remove-strict-mode</span><br></pre></td></tr></table></figure>
<p>在.babelrc文件中添加：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [<span class="string">"transform-remove-strict-mode"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>问题 3 ？？ 此时能滑动了在移动端模式下页面上点击滑来滑去console中出现一下信息警告：<br>[Intervention] Unable to preventDefault inside passive event listener due to target being treated as passive.</p>
<p>解决方法，在样式中添加：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* &#123; <span class="attribute">touch-action</span>: pan-y;&#125;</span><br></pre></td></tr></table></figure>
<p>原因：（是chrome为了提高页面的滑动流畅度而新折腾出来的一个东西）</p>
<p>  <a href="http://www.cnblogs.com/pearl07/p/6589114.html" target="_blank" rel="noopener">http://www.cnblogs.com/pearl07/p/6589114.html</a><br>  <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/touch-action" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/CSS/touch-action</a><br>  <a href="https://www.zhangxinxu.com/wordpress/2018/07/chrome-safari-touchmove-preventdefault-treated-as-passive/" target="_blank" rel="noopener">https://www.zhangxinxu.com/wordpress/2018/07/chrome-safari-touchmove-preventdefault-treated-as-passive/</a></p>
<p>问题 4？？？ 进入页面需要刷新一次才能开始执行滑动效果，因为初始化mui的scroll时候，DOM还没有渲染好</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mounted()&#123; // 在组件中DOM元素被渲染好后，会执行此vue的生命周期mounted钩子函数</span><br><span class="line">    mui(&apos;.mui-scroll-wrapper&apos;).scroll(&#123;</span><br><span class="line">        deceleration: 0.0005 //flick 减速系数，默认值0.0006</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>问题 5？？？ 此时点击底部的路由导航，失灵了,点击无效</p>
<p>分析：在App.vue中去掉mui-tab-item这个类名，路由又能点击了，可能是这个class类名与之前的某些操作有冲突，解决方法：样式copy不变，将mui-tab-item更名为 j-mui-tab-item</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.mui-bar-tab</span> <span class="selector-class">.j-mui-tab-item</span><span class="selector-class">.mui-active</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#007aff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.mui-bar-tab</span> <span class="selector-class">.j-mui-tab-item</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: table-cell;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#929292</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.mui-bar-tab</span> <span class="selector-class">.j-mui-tab-item</span> <span class="selector-class">.mui-icon</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">24px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">24px</span>;</span><br><span class="line">    <span class="attribute">padding-top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding-bottom</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.mui-bar-tab</span> <span class="selector-class">.j-mui-tab-item</span> <span class="selector-class">.mui-icon</span>~<span class="selector-class">.mui-tab-label</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">11px</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="图片详情"><a href="#图片详情" class="headerlink" title="图片详情"></a>图片详情</h2><ul>
<li><p>导入评论子组件</p>
<ol>
<li><p>导入comment.vue</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> comment <span class="keyword">from</span> <span class="string">'../subcoms/comment.vue'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建评论组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">components: &#123;</span><br><span class="line">    <span class="string">'cmt-box'</span>: comment</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建组件标签，要传递一个id过去</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cmt-box</span> <span class="attr">:id</span>=<span class="string">"this.id"</span>&gt;</span><span class="tag">&lt;/<span class="name">cmt-box</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>图片展示预览</p>
<ol>
<li><p>使用 <a href="https://github.com/LS1231/vue-preview" target="_blank" rel="noopener">vue-preview</a> 这个集成了 PhotoSwipe 图片预览插件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> NOTICE: This plugin currently support vue2.5 and above</span></span><br><span class="line">npm i vue-preview -S</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装插件，在main.js中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> VuePreview <span class="keyword">from</span> <span class="string">'vue-preview'</span></span><br><span class="line"><span class="comment">// defalut install</span></span><br><span class="line">Vue.use(VuePreview)</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--页面上放下面的代码，其中thumbImg是图片列表数组--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">vue-preview</span> <span class="attr">:slides</span>=<span class="string">"thumbImg"</span> @<span class="attr">close</span>=<span class="string">"handleClose"</span>&gt;</span><span class="tag">&lt;/<span class="name">vue-preview</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2. 在获取图片的成功回调中根据文档循环每个图片，补全预览时候图片的宽和高</span></span><br><span class="line">res.body.message.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    item.msrc = item.src;</span><br><span class="line">    item.w = <span class="number">600</span>;</span><br><span class="line">    item.h = <span class="number">400</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">this</span>.thumbImg = res.body.message;</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*因为插件中使用的figure是块元素，想要图片水平排列要加inline-block，同时可以设置显示图片的宽高*/</span></span><br><span class="line"><span class="selector-tag">figure</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">60px</span>;</span><br><span class="line">    img &#123;</span><br><span class="line">        <span class="selector-tag">width</span>: 60<span class="selector-tag">px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>
<h2 id="在手机上进行项目的预览和测试"><a href="#在手机上进行项目的预览和测试" class="headerlink" title="在手机上进行项目的预览和测试"></a>在手机上进行项目的预览和测试</h2><ul>
<li>保证手机和电脑处于同一WiFi环境</li>
<li>在项目的package.json的dev中添加一个 –host 指令，把当前WiFi的IP地址设置为 –host的指令值</li>
<li>Total Contral</li>
</ul>
<h2 id="编程式的导航"><a href="#编程式的导航" class="headerlink" title="编程式的导航"></a>编程式的导航</h2><ul>
<li><p><a href="https://router.vuejs.org/zh/guide/essentials/navigation.html" target="_blank" rel="noopener">编程式导航中文文档</a></p>
</li>
<li><p>创建组件模块</p>
</li>
<li><p>引入组件模块，创建路由</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> goodsInfo <span class="keyword">from</span> <span class="string">'./coms/goods/goodsInfo.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 商品列表 name是这个路由的别名，为了后面实现编程式导航使用这个属性</span></span><br><span class="line">&#123; <span class="attr">path</span>: <span class="string">'/home/goodsInfo/:id'</span>, <span class="attr">component</span>: goodsInfo, <span class="attr">name</span>: <span class="string">'goodsInfo'</span> &#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p>实现跳转：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;goods-item&quot; v-for=&quot;item in goodsList&quot; :key=&quot;item.id&quot; @click=&quot;getGoodsInfo(item.id)&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">// 以下三种方法都可以，可根据需求来写，注意：如果提供了path，params会被忽略。</span><br><span class="line">// 最后都能跳转到 /home/goodsInfo/123</span><br><span class="line">getGoodsInfo(id=123)&#123;</span><br><span class="line">    // this.$router.push(&#123;path: `/home/goodsInfo/$&#123;id&#125;`&#125;)</span><br><span class="line">    // this.$router.push(&#123;name: &apos;goodsInfo&apos;, params: &#123;id&#125;&#125;)</span><br><span class="line">    this.$router.push(&apos;/home/goodsInfo/&apos; + id)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="封装轮播图组件"><a href="#封装轮播图组件" class="headerlink" title="封装轮播图组件"></a>封装轮播图组件</h2><ul>
<li><p>将轮播图抽离出来，做成一个能公用的组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;mt-swipe :auto=&quot;4000&quot;&gt;</span><br><span class="line">            &lt;mt-swipe-item v-for=&quot;item in banner&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">                &lt;img :src=&quot;item.img&quot; :class=&quot;&#123;wFull: isFull&#125;&quot;&gt;</span><br><span class="line">            &lt;/mt-swipe-item&gt;</span><br><span class="line">        &lt;/mt-swipe&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">        props: [&apos;banner&apos;, &apos;isFull&apos;]</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line">    .mint-swipe &#123;</span><br><span class="line">        height: 150px;</span><br><span class="line">        .mint-swipe-item &#123;</span><br><span class="line">            text-align: center;</span><br><span class="line">            img &#123;</span><br><span class="line">                height: 100%;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .wFull &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>调用的时候：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 引入组件模板，goodsBanner 是传进去的图片循环数组，isFull是宽度是否100%显示</span><br><span class="line">&lt;swiper :banner=&quot;goodsBanner&quot; :isFull=&quot;false&quot;&gt;&lt;/swiper&gt;</span><br><span class="line"></span><br><span class="line">// 引入组件模块</span><br><span class="line"> import swiper from &apos;../subcoms/swiper.vue&apos;</span><br><span class="line"></span><br><span class="line">// 在components中定义</span><br><span class="line">components: &#123;</span><br><span class="line">	swiper</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="制作加入购物车的小球动画"><a href="#制作加入购物车的小球动画" class="headerlink" title="制作加入购物车的小球动画"></a>制作加入购物车的小球动画</h2><ul>
<li><p>需求：点击购物车，小球出现从购买数量处添加到购物车，实现动画效果</p>
</li>
<li><p>html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span></span></span><br><span class="line"><span class="tag">   @<span class="attr">before-enter</span>=<span class="string">"beforeEnter"</span></span></span><br><span class="line"><span class="tag">   @<span class="attr">enter</span>=<span class="string">"enter"</span></span></span><br><span class="line"><span class="tag">   @<span class="attr">after-enter</span>=<span class="string">"afterEnter"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ball"</span> <span class="attr">v-show</span>=<span class="string">"ballFlag"</span> <span class="attr">ref</span>=<span class="string">"ball"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>css</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.ball</span> &#123; <span class="comment">/*小球最初在购买数量上面显示，点击加入购物车小球调到购物车里然后隐藏*/</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">background</span>: red;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">313px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">152px</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">99</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在data中定义一个 ballFlag:0 默认隐藏小球</span></span><br><span class="line">addCart()&#123;</span><br><span class="line">    <span class="keyword">this</span>.ballFlag = !<span class="keyword">this</span>.ballFlag</span><br><span class="line">&#125;,</span><br><span class="line">beforeEnter(el)&#123;</span><br><span class="line">    el.style.transform = <span class="string">'translate(0, 0)'</span></span><br><span class="line">&#125;,</span><br><span class="line">enter(el, done)&#123;</span><br><span class="line">    <span class="comment">// 获取小球需要移动的距离</span></span><br><span class="line">    <span class="comment">// id为badge的元素就是home页面中购物车徽章的那个元素</span></span><br><span class="line">    <span class="keyword">let</span> ballPos = <span class="keyword">this</span>.$refs.ball.getBoundingClientRect(); <span class="comment">//小球位置</span></span><br><span class="line">    <span class="keyword">let</span> badgePos = <span class="built_in">document</span>.getElementById(<span class="string">'badge'</span>).getBoundingClientRect(); <span class="comment">//目标位置</span></span><br><span class="line">    <span class="comment">// x和y需要移动的距离</span></span><br><span class="line">    <span class="keyword">let</span> xDist = badgePos.left - ballPos.left;</span><br><span class="line">    <span class="keyword">let</span> yDist = badgePos.top - ballPos.top;</span><br><span class="line"></span><br><span class="line">    el.offsetWidth; <span class="comment">// 保证小球有动画</span></span><br><span class="line">    el.style.transform = <span class="string">`translate(<span class="subst">$&#123;xDist&#125;</span>px, <span class="subst">$&#123;yDist&#125;</span>px)`</span>;</span><br><span class="line">    el.style.transition = <span class="string">'all .8s cubic-bezier(.65,-0.71,1,.59)'</span>;</span><br><span class="line">    done(); <span class="comment">// 调用afterEnter()</span></span><br><span class="line">&#125;,</span><br><span class="line">afterEnter(el)&#123;</span><br><span class="line">    <span class="keyword">this</span>.ballFlag = !<span class="keyword">this</span>.ballFlag</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>备注：</p>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect" target="_blank" rel="noopener">获取元素大小和相对视口的位置</a></li>
<li><a href="http://cubic-bezier.com" target="_blank" rel="noopener">在线制作贝塞尔transition曲线</a></li>
</ul>
</li>
</ul>
<h2 id="将库存数量作为numbox的最大值"><a href="#将库存数量作为numbox的最大值" class="headerlink" title="将库存数量作为numbox的最大值"></a>将库存数量作为numbox的最大值</h2><ul>
<li><p>父组件-html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--在组件上定义一个max值传递给子组件，这个值就是库存数--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">numBox</span> @<span class="attr">sendSelNum</span>=<span class="string">"getSelNum"</span> <span class="attr">:max</span>=<span class="string">"goodsInfo.stock_quantity"</span>&gt;</span><span class="tag">&lt;/<span class="name">numBox</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>子组件接受-html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--data-numbox-max前面加冒号表明后面是一个表达式，即接受父组件传递过来的max--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mui-numbox"</span> <span class="attr">data-numbox-min</span>=<span class="string">'1'</span> <span class="attr">:data-numbox-max</span>=<span class="string">'max'</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">props: [<span class="string">'max'</span>], <span class="comment">// 在props中接受父组件传递来的max</span></span><br><span class="line">watch: &#123; <span class="comment">// 监听父组件传递过来的max值的变化，将变化后的值作为numbox的最大值</span></span><br><span class="line">    <span class="string">'max'</span>: <span class="function"><span class="keyword">function</span> (<span class="params">newVal, oldVal</span>)</span>&#123;</span><br><span class="line">        <span class="comment">// 使用js API设置numbox的最大值</span></span><br><span class="line">        mui(<span class="string">".mui-numbox"</span>).numbox().setOption(<span class="string">'max'</span>, newVal)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</div><div class="tags"><a href="/tags/cms/">cms</a></div><div class="post-nav"><a class="pre" href="/2019/01/30/vuex/">vuex</a><a class="next" href="/2019/01/23/webpack-ui/">webpack-ui</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank"><input type="search" name="word" maxlength="20" placeholder="Search"><input type="hidden" name="si" value="jiangleiundo.github.io"><input name="tn" type="hidden" value="bds"><input name="cl" type="hidden" value="3"><input name="ct" type="hidden" value="2097152"><input name="s" type="hidden" value="on"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Demo/">Demo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mood/">Mood</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Study/">Study</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/valid/" style="font-size: 15px;">valid</a> <a href="/tags/MongoDB/" style="font-size: 15px;">MongoDB</a> <a href="/tags/Node/" style="font-size: 15px;">Node</a> <a href="/tags/Express/" style="font-size: 15px;">Express</a> <a href="/tags/Promise/" style="font-size: 15px;">Promise</a> <a href="/tags/JavaScript/" style="font-size: 15px;">JavaScript</a> <a href="/tags/book/" style="font-size: 15px;">book</a> <a href="/tags/carousel/" style="font-size: 15px;">carousel</a> <a href="/tags/CSS/" style="font-size: 15px;">CSS</a> <a href="/tags/Gzip/" style="font-size: 15px;">Gzip</a> <a href="/tags/express/" style="font-size: 15px;">express</a> <a href="/tags/Vue/" style="font-size: 15px;">Vue</a> <a href="/tags/Echarts/" style="font-size: 15px;">Echarts</a> <a href="/tags/reg/" style="font-size: 15px;">reg</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/tool/" style="font-size: 15px;">tool</a> <a href="/tags/iview/" style="font-size: 15px;">iview</a> <a href="/tags/mongoose/" style="font-size: 15px;">mongoose</a> <a href="/tags/reactJS/" style="font-size: 15px;">reactJS</a> <a href="/tags/Tool/" style="font-size: 15px;">Tool</a> <a href="/tags/todomvc/" style="font-size: 15px;">todomvc</a> <a href="/tags/babel/" style="font-size: 15px;">babel</a> <a href="/tags/router/" style="font-size: 15px;">router</a> <a href="/tags/webpack/" style="font-size: 15px;">webpack</a> <a href="/tags/mint-ui/" style="font-size: 15px;">mint-ui</a> <a href="/tags/echarts/" style="font-size: 15px;">echarts</a> <a href="/tags/es6/" style="font-size: 15px;">es6</a> <a href="/tags/flex/" style="font-size: 15px;">flex</a> <a href="/tags/cms/" style="font-size: 15px;">cms</a> <a href="/tags/小程序/" style="font-size: 15px;">小程序</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/06/07/vue-live-components/">vue动态组件的加载</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/26/tool-use-github-gitee/">同时使用github和码云</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/13/echarts-tooltip/">echarts实现两个y轴</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/css-filter-2044/">css滤镜效果</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/03/array-sort-by-prop/">根据对象数组中的一个或多个属性给数组排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/10/Hbuilder-key/">Hbuilder快捷键</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/27/download-excel/">vue前端调后台接口下载excel文件</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/16/echarts/">一个echarts柱状图实例</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/11/book-masike/">读书笔记 -《硅谷钢铁侠》</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/02/iview-daterange/">iview中控制日期范围</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://github.com/tufu9441/maupassant-hexo" title="hexo-maupassant" target="_blank">hexo-maupassant</a><ul></ul><a href="https://github.com/jiangleiundo" title="我的GitHub" target="_blank">我的GitHub</a><ul></ul><a href="https://www.cnblogs.com/codebook/" title="博客园" target="_blank">博客园</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">小方块的世界.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>